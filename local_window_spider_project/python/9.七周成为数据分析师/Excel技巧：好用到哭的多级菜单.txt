b'Excel\xe6\x8a\x80\xe5\xb7\xa7\xef\xbc\x9a\xe5\xa5\xbd\xe7\x94\xa8\xe5\x88\xb0\xe5\x93\xad\xe7\x9a\x84\xe5\xa4\x9a\xe7\xba\xa7\xe8\x8f\x9c\xe5\x8d\x95'作者：秦路，天善智能特约专家。资深数据分析师，数据化运营专家。擅长结合运营和数据，建立数据化运营体系。
个人公众号：秦路（微信ID：tracykanc）
 今天我教大家打造出多级菜单。
Excel处理的时候总是会遇到各种各样的录入数据。而且数据被要求固定格式，比如产品的规格，公司部门等。
这时候有一份下拉菜单将会提供很大的便利。不过当你需要像曾经的作者君一样手动录入中国省市区三列数据时，你会发现下拉菜单然并卵，几百个数据像腹泻一样拉到死啊！
ok，下面简单举一个例子。
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw66jZNFKMmmJwXQRWTRCGCaj3kzsNUFtZvW4nrRdmibFrJ15pUrJ2Gvbg/640?wx_fmt=png
图示是一份简单的公司员工数据。我们可以看到部门基本只有市场、行政、财务、采购、技术五个。
先来个开胃小菜，简单设置个菜单。
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6Z3bzeV6CvHdzicrxV26hvwibfEdGlJ3npOhmYqBH49UeQW9kXial4JqpQ/640?wx_fmt=png
移动到你要提供下拉菜单的单元格，在［数据］选项卡中有一个数据验证，经常被我们用来固定格式。选择［数据验证］
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6REiaHCe8AxguFGX7ZPojykbLzaughIMKiaPtuW7zZQoN5vARiaYibvuHqQ/0?
把允许设置成［列表］，而源，就是给我们提供的下拉选项。
在源中我们需要的数据，<span style="color: rgb(227, 55, 55);">用英文逗号隔开</span>。Excel请多注意中英文符号差异，老外的软件就是这么蛋疼。
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6OE4FPp6nxvz9YWVV3Hsxfqcibz7NSF8QtXw6jMYT3htK6xiajakOHkWw/0?
点击确定，接下来就是见证奇迹的时刻！
我们会发现我们选择的单元格旁边会多出一个性感的倒三角，仿佛对我们呐喊：拉下我，拉下我。
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6bgAlDJm6SA50pNJDApKjJWOHrkeSjLPg8ITa4Od6BxITic6vnPQGsuQ/0?
然后就出现我们输入的数据了。如果你不小心输了一个中文逗号，你会想去死的。
接下来你是不是马不停蹄的在员工那里也输入了一大串中文，期待也有一个高级的下拉菜单呢？
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6miadpo0b7BsBAia8asUUibbg20UssAKHmge7p7ohUHMhPiczOB1fpibkqSQ/0?
然后……
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6sJsSvEI6xwMHKZsXk5MiaVKTDD94ArOY4fMichTxlLPwsypjCficocibeg/0?
再次不争气的哭了，这太长了啊，一点也不方便。
没错，当数据多到一定程度以后，单一的下拉菜单并不方便。那么有没有可能当我在菜单中选择市场部门以后，自动跳出来市场部门的员工呢？这样不是很方便输入了吗？这个需求是能做到的。
这就是今天的主题，多级菜单。
另外作者君再大发慈悲的告诉你一下，其实源数据也是可以选择区域的。
比如~
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6ZSpnfENiaZejGL1iaZ0oYshzgicfFveawINyCmBbsSE8qPxkF9micsuTsg/0?
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6xfxZMsMpoBESPbn1AcwUFLU7YDkqs6CxoAN6V5cmLzUpALy1z1ecgA/0?
两个效果是一样的，你真的不用打那么多字~
sorry~说晚了，其实作者君很善良。
我们简单看一下淘宝，理解多级菜单的概念。
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6vnhuMniaCYb8G3HfmjyKvJzIK3hVqSdXsBPCfhhmYAlqu7DLkKbY3ag/0?
上图就是最常见的树状多级菜单。
当我们选了衣服箱包，右边会自然的浮现出二级菜单。极大的方便了我们的选择。接下来我们在Excel上要实现的也是这样的功能。
骗你的，当然没那么高级啦。
呵呵嗒。
现在新建一个表，把部门和员工都归类放好，属于该部门的都放在该列下面。
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6S4R9AuWacnW2sGk3Qtu4qDTdMj7meDtsoJrVwSzdCHxhdcicy6689zg/0?
为了使用多级菜单，我们必须告诉Excel，这个部门里到底有哪些员工，这样才能让二级菜单相应的显示我们需要的选项。
在［公式］中选择［定义名称］
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6nGfWR6iaBoZqVIzZgcyWBib0IEXHvf9NLcE5o9pYTQOHIliceyVLCrltA/0?
这是一个很强大的功能，我会在之后的几个技巧中再详细介绍。
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6cH1zMmia20U5EPle5zE7187VibAewq5p6s1QEyCDbUqgR9hAiaC4ZfGCA/0?
新建一个名称，名称写市场，区域选择市场下的所有员工姓名。
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6Jre8PycgbF6iaAotIibGCGtsbsYmAWuoiaKengMRB7jq8uexJKo9ib4sow/0?
可以简单的理解，现在市场这个数据，已经包含了王小天，右婷在内的所有市场员工。
市场＝王小天、右婷、李诗…
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6lKgUxcVHEbuNfSCBTXxaO2k3nmNYLXlBUTNqTjA5tmhygvpNQmw6aA/0?
依次把其他名称也填写好。
接下来有请 ＝indirect() 函数，它代表引用单元格的值。
我们刚刚定义了市场＝王小天、右婷、李诗…
此时用indirect引用［市场］，就代表引用了王小天、右婷、李诗等。
又是见证奇迹的时刻了！
http://mmbiz.qpic.cn/mmbiz_png/egDQPiaUh6yls8WsXkdsCSH682xm0iadw6cc6vHcBcLtWFJRa5wV0tkANysTgoeQXzubN1PGI4l4tmvpqmo4tDxw/0?
